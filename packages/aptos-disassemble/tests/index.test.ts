import { describe, it, expect } from "vitest";
import { disassemble_to_string } from "../src/index";
import { bcs, Deserializer } from "aptos-bcs";
import * as fs from "fs";
import {
  type SignatureToken,
  load_signature_token,
  Constant,
  Metadata,
  StructDefinition,
  FieldDefinition,
  VariantDefinition,
  StructDefInstantiation,
  Visibility,
  CodeUnit,
  load_code,
  FunctionDefinition,
  FieldHandle,
  FieldInstantiation,
  ModuleHandle,
  VariantFieldHandle,
  VariantFieldInstantiation,
  StructVariantHandle,
  StructVariantInstantiation,
  disassembleMoveModule,
} from "../src/types";
describe("disassembleMoveModule", () => {
  it("should return not implemented message", () => {
    const module = Buffer.from(
      "0xa11ceb0b0700000a0d01001c021c2c0348ec0104b4021a05ce02da0107a804f00808980d2006b80d4410fc0ddd030ad911590cb2129e060dd018140fe4180200000006000f001c001f002100250028002a002e00350039003f0048000108000105040106010007070000090600000a0800020e0402030100010010060000180600062707010000001b00010001031d02010001021e0104020304010420020601060105220808000100230901000100240a0800010626010c01000107290d010001082b01080001082c01010001032d02010001092f0e08000106300f0c010001013110080106010032110100010933120100010834010800010a290801000105360808000109370e1300010038150100010b3a01010001003b16010001023c191302030001023d1a1b02030001023e1c01020300010c401d01000101411e010106010042200100010c43010800010044010800010045010800010046210100010047000100010d4901130001014a0f01010601020303050307070b07080d080e05180319031a031c0524221c0702060c030001060c020e0802010b050209000901010802010b010109000108030103080c050303050a030a020308060c050303050a030a0203010a02010b0801090004060c03030b08010a02010501090001060b0101090003060c070b010108020802020b0801030a03010104010b0801030708000802090c050303050a030a02030b08010a02010c01020107080002060b050209000901090002070b050209000901090001090103070b0502090009010900090103060c050302070b010109000900020708040e02060c0502060c0e0108070307080003070305626c6f636b0d426c6f636b5265736f75726365066865696768740e65706f63685f696e74657276616c106e65775f626c6f636b5f6576656e74730b4576656e7448616e646c65056576656e740d4e6577426c6f636b4576656e741c7570646174655f65706f63685f696e74657276616c5f6576656e74731855706461746545706f6368496e74657276616c4576656e740d436f6d6d6974486973746f72790c6d61785f6361706163697479086e6578745f696478057461626c650f5461626c65576974684c656e677468117461626c655f776974685f6c656e677468084e6577426c6f636b04686173680565706f636805726f756e641b70726576696f75735f626c6f636b5f766f7465735f6269747665630870726f706f736572176661696c65645f70726f706f7365725f696e64696365731174696d655f6d6963726f7365636f6e64731355706461746545706f6368496e74657276616c126f6c645f65706f63685f696e74657276616c126e65775f65706f63685f696e74657276616c0a696e697469616c697a651073797374656d5f616464726573736573166173736572745f6170746f735f6672616d65776f726b036e6577076163636f756e74106e65775f6576656e745f68616e646c65056572726f7210696e76616c69645f617267756d656e740e626c6f636b5f70726f6c6f67756515626c6f636b5f70726f6c6f6775655f636f6d6d6f6e066f7074696f6e046e6f6e65064f7074696f6e0a72616e646f6d6e6573730c6f6e5f6e65775f626c6f636b0f7265636f6e66696775726174696f6e196c6173745f7265636f6e66696775726174696f6e5f74696d650b7265636f6e666967757265096173736572745f766d057374616b65136765745f76616c696461746f725f696e64657804736f6d6507636f756e74657214656d69745f6e65775f626c6f636b5f6576656e741d7570646174655f706572666f726d616e63655f737461746973746963730d63757272656e745f65706f63680d73746174655f73746f72616765117065726d697373696f6e5f64656e6965641a69735f63757272656e745f65706f63685f76616c696461746f7212626c6f636b5f70726f6c6f6775655f657874187265636f6e66696775726174696f6e5f776974685f646b67097472795f737461727418656d69745f67656e657369735f626c6f636b5f6576656e7408636f6e7461696e730672656d6f7665036164640974696d657374616d70127570646174655f676c6f62616c5f74696d650a656d69745f6576656e7419656d69745f77726974657365745f626c6f636b5f6576656e74106e6f775f6d6963726f7365636f6e6473186765745f63757272656e745f626c6f636b5f686569676874176765745f65706f63685f696e74657276616c5f7365637319696e697469616c697a655f636f6d6d69745f686973746f72791f7570646174655f65706f63685f696e74657276616c5f6d6963726f736563730866656174757265731e6d6f64756c655f6576656e745f6d6967726174696f6e5f656e61626c656404656d69740767656e657369730000000000000000000000000000000000000000000000000000000000000001052000000000000000000000000000000000000000000000000000000000000000000520000000000000000000000000000000000000000000000000000000000000000114636f6d70696c6174696f6e5f6d65746164617461090003322e3003322e31126170746f733a3a6d657461646174615f7631a90303010000000000000031454e554d5f4e45575f424c4f434b5f4556454e54535f444f45535f4e4f545f4d415443485f424c4f434b5f48454947485447546865206e756d626572206f66206e657720626c6f636b206576656e747320646f6573206e6f7420657175616c207468652063757272656e7420626c6f636b206865696768742e02000000000000001145494e56414c49445f50524f504f5345525c416e20696e76616c69642070726f706f736572207761732070726f76696465642e204578706563746564207468652070726f706f73657220746f2062652074686520564d206f7220616e206163746976652076616c696461746f722e030000000000000012455a45524f5f4d41585f434150414349545937546865206d6178696d756d206361706163697479206f662074686520636f6d6d697420686973746f72792063616e6e6f7420626520302e02084e6577426c6f636b0104001355706461746545706f6368496e74657276616c01040002176765745f65706f63685f696e74657276616c5f73656373010100186765745f63757272656e745f626c6f636b5f68656967687401010000020402030303040b01010802080b010108030402030b0e0c0e0d0b05020e08020602081105120313030203140a021505160a0317030202081105120313030203140a021505160a03170307020219031a0303020219031a0300030000011b0a0011010a010600000000000000002404160a0049d00700004900000000380012012d010a000600000000000000000b010a0038010b00380212002d00020b000106030000000000000011042705000002000108180e000b010a020a030b040b050b060a0711060c080e000b020b03380311080b071109170b082603160517110a0206000002000114410a00110b0a04070021043d080c080b08043838040c090a04070022031105150a04110c38050c0907012a000c0a0a0a100038060a0a0f01150b010b020b030a0a1001140b060b040a050b0712030c0b0b000a0a0f000b0b110f0b090b051110111111120b0a100214020b00010602000000000000001113270a0411140c08050815000002000108180e000b010a020a030b040b050b060a0711060c090e000b020b030b0811080b071109170b092603160517111602170000020001181107012a000c010e000b010f000700060000000000000000060000000000000000060000000000000000401700000000000000000700400800000000000000000600000000000000001203110f020f000001011f3f070129010304052607012a010c030a031003140c040a0310040a043807031105160a030f040a043808010a030f040a040a023809280b044901000000160a03100514190b030f03150b000e021006140e02100714111b0a012e38060e0210081421043a0b010b02380a020b01010601000000000000001104271d0100020001181b0a00110b07012a000c020a02100038060a020f01150b000a020f000b01111106ffffffffffffffff0b0210011440170000000000000000070040080000000000000000111e1203110f021f01000100010507012b00100114022001000100010707012b001002140640420f00000000001a022101000001100a01490000000024040b0b000b014900000000380012012d01020b0001060300000000000000110427220100010023260b0011010a0106000000000000000024042307012a000c020a021002140c030a020f020c040a010b04151123041c0b02010b030b011204380b020b020f090b030b011205380c051b0603000000000000001104270002000000010101010201000305030703030003004b00".replace(
        "0x",
        ""
      ),
      "hex"
    );
    // console.log(disassembleMoveModule(module));

    // console.log('Module Handles:', module_handles);
    // console.log('Struct Handles:', struct_handles);
    // console.log('Function Handles:', function_handles);
    // console.log('Function Inst:', function_inst);
    // console.log('Signatures:', signatures);
    // console.log('Constant Pool:', constant_pool);
    // console.log('Identifiers:', identifiers);
    // console.log('Address Identifiers:', address_identifiers);
    // console.log('Metadatas:', metadatas.map(m => ({
    //     key: Buffer.from(m.key).toString('utf-8'),
    //     value: m.value
    // })));

    // console.log('Function Definitions:', function_defs);
    // console.log('Struct Definitions:', struct_defs);
    // console.log('Field Definitions:', field_defs);
    // console.log('Field Instantiations:', field_insts);
    // console.log('Friend Declarations:', friend_decls);
    // console.log('Variant Field Handles:', variant_field_handles);
    // console.log('Variant Field Instantiations:', variant_field_inst);
    // console.log('Struct Variant Handles:', struct_variant_handles);
    // console.log('Struct Variant Instantiations:', struct_variant_inst);
  });

  it("test use url", async () => {
    // curl --request GET \
    // --url https://api.mainnet.aptoslabs.com/v1/accounts/0x1/modules
    const result =  await (await fetch('https://api.mainnet.aptoslabs.com/v1/accounts/0x1/modules')).json();
    for (const module of result) {
        const bytecode = Buffer.from((module.bytecode as string).replace(/^0x/i, ''), 'hex');
        console.log('Module Name:', module.abi.name);
        const disassembled = disassembleMoveModule(bytecode);
        expect(disassembled).toMatchSnapshot();
        expect(disassemble_to_string(bytecode)).toMatchSnapshot();
    }
  });

  it("test string", () => {
    const module = Buffer.from(
      "0xa11ceb0b0700000a0d01001c021c2c0348ec0104b4021a05ce02da0107a804f00808980d2006b80d4410fc0ddd030ad911590cb2129e060dd018140fe4180200000006000f001c001f002100250028002a002e00350039003f0048000108000105040106010007070000090600000a0800020e0402030100010010060000180600062707010000001b00010001031d02010001021e0104020304010420020601060105220808000100230901000100240a0800010626010c01000107290d010001082b01080001082c01010001032d02010001092f0e08000106300f0c010001013110080106010032110100010933120100010834010800010a290801000105360808000109370e1300010038150100010b3a01010001003b16010001023c191302030001023d1a1b02030001023e1c01020300010c401d01000101411e010106010042200100010c43010800010044010800010045010800010046210100010047000100010d4901130001014a0f01010601020303050307070b07080d080e05180319031a031c0524221c0702060c030001060c020e0802010b050209000901010802010b010109000108030103080c050303050a030a020308060c050303050a030a0203010a02010b0801090004060c03030b08010a02010501090001060b0101090003060c070b010108020802020b0801030a03010104010b0801030708000802090c050303050a030a02030b08010a02010c01020107080002060b050209000901090002070b050209000901090001090103070b0502090009010900090103060c050302070b010109000900020708040e02060c0502060c0e0108070307080003070305626c6f636b0d426c6f636b5265736f75726365066865696768740e65706f63685f696e74657276616c106e65775f626c6f636b5f6576656e74730b4576656e7448616e646c65056576656e740d4e6577426c6f636b4576656e741c7570646174655f65706f63685f696e74657276616c5f6576656e74731855706461746545706f6368496e74657276616c4576656e740d436f6d6d6974486973746f72790c6d61785f6361706163697479086e6578745f696478057461626c650f5461626c65576974684c656e677468117461626c655f776974685f6c656e677468084e6577426c6f636b04686173680565706f636805726f756e641b70726576696f75735f626c6f636b5f766f7465735f6269747665630870726f706f736572176661696c65645f70726f706f7365725f696e64696365731174696d655f6d6963726f7365636f6e64731355706461746545706f6368496e74657276616c126f6c645f65706f63685f696e74657276616c126e65775f65706f63685f696e74657276616c0a696e697469616c697a651073797374656d5f616464726573736573166173736572745f6170746f735f6672616d65776f726b036e6577076163636f756e74106e65775f6576656e745f68616e646c65056572726f7210696e76616c69645f617267756d656e740e626c6f636b5f70726f6c6f67756515626c6f636b5f70726f6c6f6775655f636f6d6d6f6e066f7074696f6e046e6f6e65064f7074696f6e0a72616e646f6d6e6573730c6f6e5f6e65775f626c6f636b0f7265636f6e66696775726174696f6e196c6173745f7265636f6e66696775726174696f6e5f74696d650b7265636f6e666967757265096173736572745f766d057374616b65136765745f76616c696461746f725f696e64657804736f6d6507636f756e74657214656d69745f6e65775f626c6f636b5f6576656e741d7570646174655f706572666f726d616e63655f737461746973746963730d63757272656e745f65706f63680d73746174655f73746f72616765117065726d697373696f6e5f64656e6965641a69735f63757272656e745f65706f63685f76616c696461746f7212626c6f636b5f70726f6c6f6775655f657874187265636f6e66696775726174696f6e5f776974685f646b67097472795f737461727418656d69745f67656e657369735f626c6f636b5f6576656e7408636f6e7461696e730672656d6f7665036164640974696d657374616d70127570646174655f676c6f62616c5f74696d650a656d69745f6576656e7419656d69745f77726974657365745f626c6f636b5f6576656e74106e6f775f6d6963726f7365636f6e6473186765745f63757272656e745f626c6f636b5f686569676874176765745f65706f63685f696e74657276616c5f7365637319696e697469616c697a655f636f6d6d69745f686973746f72791f7570646174655f65706f63685f696e74657276616c5f6d6963726f736563730866656174757265731e6d6f64756c655f6576656e745f6d6967726174696f6e5f656e61626c656404656d69740767656e657369730000000000000000000000000000000000000000000000000000000000000001052000000000000000000000000000000000000000000000000000000000000000000520000000000000000000000000000000000000000000000000000000000000000114636f6d70696c6174696f6e5f6d65746164617461090003322e3003322e31126170746f733a3a6d657461646174615f7631a90303010000000000000031454e554d5f4e45575f424c4f434b5f4556454e54535f444f45535f4e4f545f4d415443485f424c4f434b5f48454947485447546865206e756d626572206f66206e657720626c6f636b206576656e747320646f6573206e6f7420657175616c207468652063757272656e7420626c6f636b206865696768742e02000000000000001145494e56414c49445f50524f504f5345525c416e20696e76616c69642070726f706f736572207761732070726f76696465642e204578706563746564207468652070726f706f73657220746f2062652074686520564d206f7220616e206163746976652076616c696461746f722e030000000000000012455a45524f5f4d41585f434150414349545937546865206d6178696d756d206361706163697479206f662074686520636f6d6d697420686973746f72792063616e6e6f7420626520302e02084e6577426c6f636b0104001355706461746545706f6368496e74657276616c01040002176765745f65706f63685f696e74657276616c5f73656373010100186765745f63757272656e745f626c6f636b5f68656967687401010000020402030303040b01010802080b010108030402030b0e0c0e0d0b05020e08020602081105120313030203140a021505160a0317030202081105120313030203140a021505160a03170307020219031a0303020219031a0300030000011b0a0011010a010600000000000000002404160a0049d00700004900000000380012012d010a000600000000000000000b010a0038010b00380212002d00020b000106030000000000000011042705000002000108180e000b010a020a030b040b050b060a0711060c080e000b020b03380311080b071109170b082603160517110a0206000002000114410a00110b0a04070021043d080c080b08043838040c090a04070022031105150a04110c38050c0907012a000c0a0a0a100038060a0a0f01150b010b020b030a0a1001140b060b040a050b0712030c0b0b000a0a0f000b0b110f0b090b051110111111120b0a100214020b00010602000000000000001113270a0411140c08050815000002000108180e000b010a020a030b040b050b060a0711060c090e000b020b030b0811080b071109170b092603160517111602170000020001181107012a000c010e000b010f000700060000000000000000060000000000000000060000000000000000401700000000000000000700400800000000000000000600000000000000001203110f020f000001011f3f070129010304052607012a010c030a031003140c040a0310040a043807031105160a030f040a043808010a030f040a040a023809280b044901000000160a03100514190b030f03150b000e021006140e02100714111b0a012e38060e0210081421043a0b010b02380a020b01010601000000000000001104271d0100020001181b0a00110b07012a000c020a02100038060a020f01150b000a020f000b01111106ffffffffffffffff0b0210011440170000000000000000070040080000000000000000111e1203110f021f01000100010507012b00100114022001000100010707012b001002140640420f00000000001a022101000001100a01490000000024040b0b000b014900000000380012012d01020b0001060300000000000000110427220100010023260b0011010a0106000000000000000024042307012a000c020a021002140c030a020f020c040a010b04151123041c0b02010b030b011204380b020b020f090b030b011205380c051b0603000000000000001104270002000000010101010201000305030703030003004b00".replace(
        "0x",
        ""
      ),
      "hex"
    );

    /*
                { module: 0, name: 1, abilities: 8, type_parameters: [] },
                { module: 1, name: 5, abilities: 4, type_parameters: [Array] },
                { module: 0, name: 7, abilities: 7, type_parameters: [] },
                { module: 0, name: 9, abilities: 6, type_parameters: [] },
                { module: 0, name: 10, abilities: 8, type_parameters: [] },
                { module: 2, name: 14, abilities: 4, type_parameters: [Array] },
                { module: 0, name: 16, abilities: 6, type_parameters: [] },
                { module: 0, name: 24, abilities: 6, type_parameters: [] },
                { module: 6, name: 39, abilities: 7, type_parameters: [Array] }
            */

    const result = disassembleMoveModule(module);
    expect(result).toMatchSnapshot();
    const disassembledString = disassemble_to_string(module);
    expect(disassembledString).toMatchSnapshot();
  });

  it("test string with metadata", () => {
    let i = "a11ceb0b0700000a0b010016021636034cc5010491021205a302e302078605f60508fc0a4010bc0bb1010aed0c410cae0dfe170dac25100000011401150118011a01200121011101240131013700010c0000040700000707000008070000090700000b0700000f0c000113070003170701000004190700051f030008260700082a0700001200010001021603040001041b05060001031c0801010001031d090a010001001e0c0d000106220e0300010723020f0001082510110001052712130001052812130001082910140001082b15010001002c17020001002d19020001002e1c1d0001002f1c1e0001033002090100010932022100010033020f000103340a0901000100351c01000100360e0200010a380a02010601003903270001093a02290001003b0e2a0001003c03010001003d2d010001003e2e2f0001003f3202000100400e020001030704071120142017251733032004201734040505080708070101000105010b08010a0809030508070807010809010a080901060b08010900010b08010900010900090b08010a080908090a0809060a080901030306080901020c080a010c01060c0103010a0201080b0106080a01060a0201080c0306080c06080b0a020506080603080b060a02080c02060c0a0204030806070806070a0203070800080503010a030201070301060800010b08010804010a0805010805010804010d030a080503080506030103010303060a080503010301080501080202030a0a03020a0a0303080a0a0303010a0303010a0a030608000102010800060a0a0303010a030301020301020708000302060a0303020a030317010a0a03030301060a03030a03030a030a030a0301070a0a0307030a0a030a03030a030a030a030a03060a0308030a03030301030a030a0302060c030108030108010b070800010a0a03030b08010804080408000b0801080408040b0801080408040467616d650447616d6505626f6172640573636f72650947616d654d6f766564076163636f756e7409646972656374696f6e0847616d654f7665720b47616d6553746172746564074e657754696c6503706f7303506f730576616c756501720163095075626c69636b6579067075626b65790974696d657374616d701e69735f6163636f756e745f6162737472616374696f6e5f656e61626c656406537472696e6706737472696e67136163636f756e745f6162737472616374696f6e1a646973706174636861626c655f61757468656e74696361746f72064f7074696f6e066f7074696f6e0c46756e6374696f6e496e666f0d66756e6374696f6e5f696e666f1e6e65775f66756e6374696f6e5f696e666f5f66726f6d5f616464726573730769735f736f6d650c64657374726f795f736f6d650c61757468656e746963617465134162737472616374696f6e417574684461746109617574685f64617461067369676e65720a616464726573735f6f660b6e6f775f7365636f6e64730765643235353139256e65775f756e76616c6964617465645f7075626c69635f6b65795f66726f6d5f627974657314556e76616c6964617465645075626c69634b6579066469676573740d61757468656e74696361746f72186e65775f7369676e61747572655f66726f6d5f6279746573095369676e6174757265177369676e61747572655f7665726966795f7374726963740872656769737465720c6164645f6e65775f74696c65136164645f6e65775f74696c655f72616e646f6d0a66696e645f656d707479046e6f6e650a72616e646f6d6e6573730b7531365f696e74656765720a6765745f6e756d62657204736f6d650863616e5f6d6f76650967616d655f6f766572056576656e7404656d69740e6765745f67616d655f73746174650a75385f696e74656765720a696e69745f626f6172640d69735f726567697374657265640a6d6f76655f626f61726411736c6964655f616e645f636f6d62696e650a73746172745f67616d650a756e72656769737465720000000000000000000000000000000000000000000000000000000001233456000000000000000000000000000000000000000000000000000000000000000114636f6d70696c6174696f6e5f6d65746164617461090003322e3003322e31126170746f733a3a6d657461646174615f76317e00030847616d654f7665720104000947616d654d6f7665640104000b47616d6553746172746564010400040a73746172745f67616d650105000d69735f726567697374657265640101000e6765745f67616d655f73746174650101001e69735f6163636f756e745f6162737472616374696f6e5f656e61626c6564010100000202020a0a0303030102040505020a0a03060303030202030505020a0a0303030302020505020a0a030402020a08050c030502020d030e03060202100a021103000100000b360b0011010c040b010b020b0311020c050e04380004330b0438010c060e060c07090c080600000000000000000c090a0741060c0a0a090a0a2304300a070a0942060c0b0e050b0b21042b0b0701080c080b080c0c0b0c020b09060100000000000000160c0905170b07010527090c0c05290501000106162f0e0011062906042d0e0011062b060c0211070c030a0210001406100e000000000000160b032404290b0210011411080c040e0111090c050e01110a14110b0c060e060e040b0514110c04270b0002060600000000000000270b020106050000000000000027060400000000000000270d00040106181d0a0011062906030e11070c020b010b0212060c030b000b032d06020b0011062a060c0411070a040f00150b040f010c050b010b0515050d0e0000001b360e011002140604000000000000002304330e01100314060400000000000000230c030b03042f0a0010040e01100214421a0e01100314420f1406000000000000000021042b0b000f040e01100214431a0e01100314430f0c040b020b0415020b0001060800000000000000270b000106080000000000000027090c03050c0f00000022190b0011100c010e01411f0c020a0206000000000000000021040c3802021112340b02190c020e010b02421f14111312043803021500000023710600000000000000000c01090c020a02046b0b01060100000000000000160c010a010604000000000000002304670600000000000000000c03090c04051405040a0404640b03060100000000000000160c030a0306040000000000000023031f05040a0010040a01421a0a03420f140c050a0506000000000000000021042f0b000108020a0106030000000000000023033405470a0010040a0106010000000000000016421a0a03420f140c060a050b0621034305470b000108020a0306030000000000000023034c055f0a0010040a01421a0a0306010000000000000016420f140c060b050b0621035b055f0b000108020b03060100000000000000160c030512080c04051a0b00010902080c02050a0b00010569100000002441401f00000000000000000c010600000000000000000c02090c030a03043b0b02060100000000000000160c020a020604000000000000002304370600000000000000000c04090c05051605060a0504340b04060100000000000000160c040a0406040000000000000023032105060a0010040a02421a0a04420f1406000000000000000021032c05140a020a0412050c060d010b06441f0514080c05051c0b00010b0102080c03050c0b000105391600000100260d0a0011062c0013000c010c020b0011060b020b0112023804021801000100284a0a002900033e401a00000000000000000c010600000000000000000c02090c03050b05340a03043b0b02060100000000000000160c020a020604000000000000002303160534400f00000000000000000c040600000000000000000c05090c06051e052d0a0604310b05060100000000000000160c050a05060400000000000000230329052d0d04060000000000000000440f051c0d010b04441a0509080c0605240b010c070600000000000000000c050b070b0502080c0305110b002b000c080a081004140c070b081005140c050538130000000f0d1119310a19310923040a0602000000000000000c000b00020604000000000000000c0005081a0000002b3a401a00000000000000000c010b00010600000000000000000c02090c03050a05330a0304370b02060100000000000000160c020a020604000000000000002303150533400f00000000000000000c040600000000000000000c05090c06051d052c0a0604300b05060100000000000000160c050a05060400000000000000230328052c0d04060000000000000000440f051b0d010b04441a0508080c0605230b01060000000000000000120002080c0305101b010001062c130a00290604100b002b0611070c0110001406100e000000000000160b01240c020b0202090c02050e1c00000030a502090c02401a00000000000000000c030600000000000000000c040a001005140c050a010600000000000000002104a002080c060b06048c0105130a0406040000000000000023031805790a0010040a04421a0c070600000000000000000c08400f00000000000000000c090a0806040000000000000023043b0a010600000000000000002104360a080c0a0d090a070b0a420f14440f0b08060100000000000000160c0805210603000000000000000a08170c0a052b0e090b05111d0c080c0b0b080c050a010601000000000000002104760600000000000000000c08400f00000000000000000c0c0a0806040000000000000023045b0d0c0e0b0603000000000000000a0817420f14440f0b08060100000000000000160c08054a0b0c0c0d0a0203710b070e0d21200c0e0b0e03670569080c020d030b0d441a0b04060100000000000000160c0405130b0701090c0e05640b0b0c0d055d0a020489010a000f040c0f0b030b0f150b000f050c100b050b10150b02020b0001058701401a00000000000000000c110600000000000000000c080a080604000000000000002304e6010600000000000000000c0a400f00000000000000000c120a0a0604000000000000002304b5010a010602000000000000002104b0010a0a0c130d120a0010040b13421a0a08420f14440f0b0a060100000000000000160c0a0598010603000000000000000a0a170c1305a2010e120b05111d0c0a0c140b0a0c050a010603000000000000002104e3010600000000000000000c0a400f00000000000000000c150a0a0604000000000000002304d9010d150e140c070603000000000000000a0a170c130b070b13420f14440f0b0a060100000000000000160c0a05c4010b150c160d110b16441a0b08060100000000000000160c080590010b140c1605db010600000000000000000c080a080604000000000000002303ed0105790600000000000000000c0a400f00000000000000000c170a0a060400000000000000230482020d170e110a0a421a0a08420f14440f0b0a060100000000000000160c0a05f1010a02039d020a0010040a08421a0c070e170c180b070b1821200c0e0b0e039302059502080c020d030b17441a0b08060100000000000000160c0805e801090c0e0590020a01060100000000000000210c0605101d000000318d010600000000000000000c02400f00000000000000000c030a020a00410f23041b0a000a02420f140c040a0406000000000000000022031305160d030b04440f0b02060100000000000000160c0205040b00010e03410f0604000000000000002304260d03060000000000000000440f051d0600000000000000000c020a020603000000000000002304650e030a02420f140c040e030c000a02060100000000000000160c050b000b05420f140c050a040600000000000000002204620a040b05210c060b060347055d0a04060200000000000000180d030a02430f150b04060200000000000000180c070b010b07160c010600000000000000000d030a0206010000000000000016430f150b02060100000000000000160c020528090c0605440600000000000000000c02400f00000000000000000c080a020e03410f23036f0581010e030a02420f140c040a04060000000000000000220379057c0d080b04440f0b02060100000000000000160c0205690e08410f06040000000000000023048a010d08060000000000000000440f0581010b080b01021e000401003586010a0011062900044f0a0011062a000c02090c030b0304160b021004140c040b0011060b0412033805020b010c050a020a05111c04490a022e110f0c060e06380604430b0638070c070a020e071006140e07100714110e0a0011060a021004140b050a02100514120138080b022e111503400b00111605150b000105150b00010b0201060d00000000000000270b00010b0201060b00000000000000270a00111a0c080e08110f0c090e0938060482010b0938070c0a0e08110f0c0b0e0b3806047e0b0b38070c0c0d080e0a1006140e0a100714110e0d080e0c1006140e0c100714110e0a000b082d000a0011062a000c02080c03050a0b0001060900000000000000270b0001060900000000000000271f00040106020f0a0011062906040b0b0011062c0613060101020b0001060300000000000000270601060005000501000000010400040100";
    const module = Buffer.from(i.replace(/0x/g, ''), 'hex');
    const result = disassemble_to_string(module, {
      printBasicBlocks: true,
    })
    // 输出到文件
    fs.writeFileSync('./disassembled_output.txt', result);
  });
});
